=begin
#Datadog API V2 Collection

#Collection of all Datadog Public endpoints.

The version of the OpenAPI document: 1.0
Contact: support@datadoghq.com
Generated by: https://github.com/DataDog/datadog-api-client-ruby/tree/master/.generator

 Unless explicitly stated otherwise all files in this repository are licensed under the Apache-2.0 License.
 This product includes software developed at Datadog (https://www.datadoghq.com/).
 Copyright 2020-Present Datadog, Inc.

=end

require 'date'
require 'time'

module DatadogAPIClient::V2
  # Attributes of an entity risk score
  class SecurityEntityRiskScoreAttributes
    include BaseGenericModel

    # Configuration risks associated with the entity
    attr_reader :config_risks

    # Unique identifier for the entity
    attr_reader :entity_id

    # Metadata about the entity from cloud providers
    attr_reader :entity_metadata

    # Human-readable name of the entity
    attr_accessor :entity_name

    # Cloud providers associated with the entity
    attr_reader :entity_providers

    # Roles associated with the entity
    attr_accessor :entity_roles

    # Type of the entity (e.g., aws_iam_user, aws_ec2_instance)
    attr_reader :entity_type

    # Timestamp when the entity was first detected (Unix milliseconds)
    attr_reader :first_detected

    # Title of the most recent signal detected for this entity
    attr_reader :last_activity_title

    # Timestamp when the entity was last detected (Unix milliseconds)
    attr_reader :last_detected

    # Current risk score for the entity
    attr_reader :risk_score

    # Change in risk score compared to previous period
    attr_reader :risk_score_evolution

    # Severity level based on risk score
    attr_reader :severity

    # Number of security signals detected for this entity
    attr_reader :signals_detected

    attr_accessor :additional_properties

    # Attribute mapping from ruby-style variable name to JSON key.
    # @!visibility private
    def self.attribute_map
      {
        :'config_risks' => :'configRisks',
        :'entity_id' => :'entityID',
        :'entity_metadata' => :'entityMetadata',
        :'entity_name' => :'entityName',
        :'entity_providers' => :'entityProviders',
        :'entity_roles' => :'entityRoles',
        :'entity_type' => :'entityType',
        :'first_detected' => :'firstDetected',
        :'last_activity_title' => :'lastActivityTitle',
        :'last_detected' => :'lastDetected',
        :'risk_score' => :'riskScore',
        :'risk_score_evolution' => :'riskScoreEvolution',
        :'severity' => :'severity',
        :'signals_detected' => :'signalsDetected'
      }
    end

    # Attribute type mapping.
    # @!visibility private
    def self.openapi_types
      {
        :'config_risks' => :'SecurityEntityConfigRisks',
        :'entity_id' => :'String',
        :'entity_metadata' => :'SecurityEntityMetadata',
        :'entity_name' => :'String',
        :'entity_providers' => :'Array<String>',
        :'entity_roles' => :'Array<String>',
        :'entity_type' => :'String',
        :'first_detected' => :'Integer',
        :'last_activity_title' => :'String',
        :'last_detected' => :'Integer',
        :'risk_score' => :'Float',
        :'risk_score_evolution' => :'Float',
        :'severity' => :'SecurityEntityRiskScoreAttributesSeverity',
        :'signals_detected' => :'Integer'
      }
    end

    # Initializes the object
    # @param attributes [Hash] Model attributes in the form of hash
    # @!visibility private
    def initialize(attributes = {})
      if (!attributes.is_a?(Hash))
        fail ArgumentError, "The input argument (attributes) must be a hash in `DatadogAPIClient::V2::SecurityEntityRiskScoreAttributes` initialize method"
      end

      self.additional_properties = {}
      # check to see if the attribute exists and convert string to symbol for hash key
      attributes = attributes.each_with_object({}) { |(k, v), h|
        if (!self.class.attribute_map.key?(k.to_sym))
          self.additional_properties[k.to_sym] = v
        else
          h[k.to_sym] = v
        end
      }

      if attributes.key?(:'config_risks')
        self.config_risks = attributes[:'config_risks']
      end

      if attributes.key?(:'entity_id')
        self.entity_id = attributes[:'entity_id']
      end

      if attributes.key?(:'entity_metadata')
        self.entity_metadata = attributes[:'entity_metadata']
      end

      if attributes.key?(:'entity_name')
        self.entity_name = attributes[:'entity_name']
      end

      if attributes.key?(:'entity_providers')
        if (value = attributes[:'entity_providers']).is_a?(Array)
          self.entity_providers = value
        end
      end

      if attributes.key?(:'entity_roles')
        if (value = attributes[:'entity_roles']).is_a?(Array)
          self.entity_roles = value
        end
      end

      if attributes.key?(:'entity_type')
        self.entity_type = attributes[:'entity_type']
      end

      if attributes.key?(:'first_detected')
        self.first_detected = attributes[:'first_detected']
      end

      if attributes.key?(:'last_activity_title')
        self.last_activity_title = attributes[:'last_activity_title']
      end

      if attributes.key?(:'last_detected')
        self.last_detected = attributes[:'last_detected']
      end

      if attributes.key?(:'risk_score')
        self.risk_score = attributes[:'risk_score']
      end

      if attributes.key?(:'risk_score_evolution')
        self.risk_score_evolution = attributes[:'risk_score_evolution']
      end

      if attributes.key?(:'severity')
        self.severity = attributes[:'severity']
      end

      if attributes.key?(:'signals_detected')
        self.signals_detected = attributes[:'signals_detected']
      end
    end

    # Check to see if the all the properties in the model are valid
    # @return true if the model is valid
    # @!visibility private
    def valid?
      return false if @config_risks.nil?
      return false if @entity_id.nil?
      return false if @entity_metadata.nil?
      return false if @entity_providers.nil?
      return false if @entity_type.nil?
      return false if @first_detected.nil?
      return false if @last_activity_title.nil?
      return false if @last_detected.nil?
      return false if @risk_score.nil?
      return false if @risk_score_evolution.nil?
      return false if @severity.nil?
      return false if @signals_detected.nil?
      true
    end

    # Custom attribute writer method with validation
    # @param config_risks [Object] Object to be assigned
    # @!visibility private
    def config_risks=(config_risks)
      if config_risks.nil?
        fail ArgumentError, 'invalid value for "config_risks", config_risks cannot be nil.'
      end
      @config_risks = config_risks
    end

    # Custom attribute writer method with validation
    # @param entity_id [Object] Object to be assigned
    # @!visibility private
    def entity_id=(entity_id)
      if entity_id.nil?
        fail ArgumentError, 'invalid value for "entity_id", entity_id cannot be nil.'
      end
      @entity_id = entity_id
    end

    # Custom attribute writer method with validation
    # @param entity_metadata [Object] Object to be assigned
    # @!visibility private
    def entity_metadata=(entity_metadata)
      if entity_metadata.nil?
        fail ArgumentError, 'invalid value for "entity_metadata", entity_metadata cannot be nil.'
      end
      @entity_metadata = entity_metadata
    end

    # Custom attribute writer method with validation
    # @param entity_providers [Object] Object to be assigned
    # @!visibility private
    def entity_providers=(entity_providers)
      if entity_providers.nil?
        fail ArgumentError, 'invalid value for "entity_providers", entity_providers cannot be nil.'
      end
      @entity_providers = entity_providers
    end

    # Custom attribute writer method with validation
    # @param entity_type [Object] Object to be assigned
    # @!visibility private
    def entity_type=(entity_type)
      if entity_type.nil?
        fail ArgumentError, 'invalid value for "entity_type", entity_type cannot be nil.'
      end
      @entity_type = entity_type
    end

    # Custom attribute writer method with validation
    # @param first_detected [Object] Object to be assigned
    # @!visibility private
    def first_detected=(first_detected)
      if first_detected.nil?
        fail ArgumentError, 'invalid value for "first_detected", first_detected cannot be nil.'
      end
      @first_detected = first_detected
    end

    # Custom attribute writer method with validation
    # @param last_activity_title [Object] Object to be assigned
    # @!visibility private
    def last_activity_title=(last_activity_title)
      if last_activity_title.nil?
        fail ArgumentError, 'invalid value for "last_activity_title", last_activity_title cannot be nil.'
      end
      @last_activity_title = last_activity_title
    end

    # Custom attribute writer method with validation
    # @param last_detected [Object] Object to be assigned
    # @!visibility private
    def last_detected=(last_detected)
      if last_detected.nil?
        fail ArgumentError, 'invalid value for "last_detected", last_detected cannot be nil.'
      end
      @last_detected = last_detected
    end

    # Custom attribute writer method with validation
    # @param risk_score [Object] Object to be assigned
    # @!visibility private
    def risk_score=(risk_score)
      if risk_score.nil?
        fail ArgumentError, 'invalid value for "risk_score", risk_score cannot be nil.'
      end
      @risk_score = risk_score
    end

    # Custom attribute writer method with validation
    # @param risk_score_evolution [Object] Object to be assigned
    # @!visibility private
    def risk_score_evolution=(risk_score_evolution)
      if risk_score_evolution.nil?
        fail ArgumentError, 'invalid value for "risk_score_evolution", risk_score_evolution cannot be nil.'
      end
      @risk_score_evolution = risk_score_evolution
    end

    # Custom attribute writer method with validation
    # @param severity [Object] Object to be assigned
    # @!visibility private
    def severity=(severity)
      if severity.nil?
        fail ArgumentError, 'invalid value for "severity", severity cannot be nil.'
      end
      @severity = severity
    end

    # Custom attribute writer method with validation
    # @param signals_detected [Object] Object to be assigned
    # @!visibility private
    def signals_detected=(signals_detected)
      if signals_detected.nil?
        fail ArgumentError, 'invalid value for "signals_detected", signals_detected cannot be nil.'
      end
      @signals_detected = signals_detected
    end

    # Returns the object in the form of hash, with additionalProperties support.
    # @return [Hash] Returns the object in the form of hash
    # @!visibility private
    def to_hash
      hash = {}
      self.class.attribute_map.each_pair do |attr, param|
        value = self.send(attr)
        if value.nil?
          is_nullable = self.class.openapi_nullable.include?(attr)
          next if !is_nullable || (is_nullable && !instance_variable_defined?(:"@#{attr}"))
        end

        hash[param] = _to_hash(value)
      end
      self.additional_properties.each_pair do |attr, value|
        hash[attr] = value
      end
      hash
    end

    # Checks equality by comparing each attribute.
    # @param o [Object] Object to be compared
    # @!visibility private
    def ==(o)
      return true if self.equal?(o)
      self.class == o.class &&
          config_risks == o.config_risks &&
          entity_id == o.entity_id &&
          entity_metadata == o.entity_metadata &&
          entity_name == o.entity_name &&
          entity_providers == o.entity_providers &&
          entity_roles == o.entity_roles &&
          entity_type == o.entity_type &&
          first_detected == o.first_detected &&
          last_activity_title == o.last_activity_title &&
          last_detected == o.last_detected &&
          risk_score == o.risk_score &&
          risk_score_evolution == o.risk_score_evolution &&
          severity == o.severity &&
          signals_detected == o.signals_detected &&
          additional_properties == o.additional_properties
    end

    # Calculates hash code according to all attributes.
    # @return [Integer] Hash code
    # @!visibility private
    def hash
      [config_risks, entity_id, entity_metadata, entity_name, entity_providers, entity_roles, entity_type, first_detected, last_activity_title, last_detected, risk_score, risk_score_evolution, severity, signals_detected, additional_properties].hash
    end
  end
end
